<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    {include file='public/head' /}
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>无标题文档</title>
</head>
<body>
<body>
<div class="layui-header">
    {include file='public/header' /}
</div>
<a class="word-export" href="javascript:void(0)"> 导出word</a>
<div id="page-content" style="width: 90%;margin:20px auto">
    <th colspan="3" style="text-align: center;padding-bottom:30px"><img src="__STATIC__/image/login/login-logo.png" style="width:100%" id="aa"></th>
    <div id="abc">

    </div>
</div>
<script id="demo" type="text/html">
    <table id="table-list" style="width:100%;margin-bottom:20px;border-collapse: collapse;border:none">
        <thead style="background:#ccc">
        <tr align="left" style="background:#ccc">
            <th colspan="2" rowspan="2">1</th>
            <th colspan="3">2</th>
        </tr>
        <tr align="left" style="background:#ccc">
            <th>1</th>
            <th>2</th>
            <th>3</th>
        </tr>
        </thead>
        <tbody style="border:1px solid #000">
        <tr>
            <td colspan="2" rowspan="1">员工人数</td>
            <td>{{d.title}}</td>
            <td style="width: 200px;">且</td>
            <td>aaa</td>
        <tr>
            {{#  layui.each(d.list, function(index, item){ }}
        <tr>
            <td colspan="2" rowspan="1">{{item.title}}</td>
            <td>{{item.one}}</td>
            <td class="input{{index}}">{{item.two}}</td>
            <td>{{item.three}}</td>
        <tr>
            {{#  if(item.all){ }}
            {{#  layui.each(item.all, function(indexs, items){ }}
        <tr>
            {{#  if(indexs==0){ }}
            <td colspan="1" rowspan="{{item.all.length}}" style="width: 20px;"></td>
            {{#  } }}
            <td>lala</td>
            <td>{{items.one}}</td>
            <td class="input{{index}}" style="width: 200px;">{{item.two}}</td>
            <td>{{items.three}}</td>
        </tr>
        {{#  }); }}

        {{#  } }}
        {{#  }); }}
        </tbody>
    </table>
</script>
{include file='public/foot_js' /}
<script type="text/javascript" src="__STATIC__/javascript/finance/FileSaver.js"></script>
<script type="text/javascript" src="__STATIC__/javascript/finance/wors.js"></script>
<script>
    layui.use(['layer', 'form','laytpl'], function(){
        var layer = layui.layer
            ,laytpl=layui.laytpl
            ,form = layui.form;


        var data={
            title:"标题",
            list:[{
                title:'标题',
                one:'111',
                two:'112',
                three:'113',
                all:[{title:'标题',one:'a-111',two:'a-112',three:'a-113'},{title:'标题',one:'b-111',two:'b-112',three:'b-113'}]
            },{
                title:'标题',
                one:'221',
                two:'222',
                three:'223'
            },{
                title:'标题',
                one:'331',
                two:'332',
                three:'333',
                all:[{one:'a-221',two:'a-222',three:'a-223'},{one:'b-221',two:'b-222',three:'b-223'},{one:'c-221',two:'c-222',three:'c-223'}]
            },{
                title:'标题',
                one:'441',
                two:'442',
                three:'443'
            }]
        }
        var getTpl = document.getElementById("demo").innerHTML;
        laytpl(getTpl).render(data, function(html){
            document.getElementById("abc").innerHTML = html;
        });
        $("table td,table th").css({"border":"1px solid #000","text-align":"center","padding":"10px","line-height":"30px"})

        $("#table-list tbody tr").each(function(index,item){
            if($(item).find("td").length==0){
                $(item).remove();
            }
        })
    });
</script>
<script type="text/javascript">

    jQuery(document).ready(function($) {
        $("a.word-export").click(function(event) {
            console.log(event)
            $("#page-content").wordExport("测试--吕");

        });
    });
</script>

</body>

</body>
</html>