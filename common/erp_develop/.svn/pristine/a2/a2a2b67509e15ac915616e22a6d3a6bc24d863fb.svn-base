/*游客信息*/
//添加站位的非必填字段
function addClass_zw() {
    $("#occupy_count").Attr("lay-verify","required");
}

//去除站位的非必填字段
function removeClass_zw(){
    $("#occupy_count").removeAttr("lay-verify");
}

//去除编辑站位的非必填字段
function removeClass_edit_zw(){
    $("#occupy_count_edit").removeAttr("lay-verify");
}

//添加游客的非必填字段
function addClass(){
    /*$("#company_order_number_hidden").Attr("lay-verify","required");
    $("#customer_first_name").Attr("lay-verify","required");
    $("#customer_last_name").Attr("lay-verify","required");
    $("#english_last_name").Attr("lay-verify","required");
    $("#english_first_name").Attr("lay-verify","required");
    $("#card_type").Attr("lay-verify","required");
    $("#gender").Attr("lay-verify","required");
    $("#card_number").Attr("lay-verify","required");
    $("#term_of_validity").Attr("lay-verify","required");
    $("#country_id").Attr("lay-verify","required");
    $("#phone").Attr("lay-verify","required");
    $("#email").Attr("lay-verify","required");
    $("#customer_type").Attr("lay-verify","required");
    $("#language_id").Attr("lay-verify","required");
    $("#room_code").Attr("lay-verify","required");
    $("#room_type").Attr("lay-verify","required");
    $("#check_in").Attr("lay-verify","required");
    $("#check_on").Attr("lay-verify","required");
    //航班信息
    $("input[name='messageFlight']").Attr("lay-verify","required");*/
}

//去除游客的非必填字段
function removeClass(){
    /*$("#company_order_number_hidden").removeAttr("lay-verify");
    $("#customer_first_name").removeAttr("lay-verify");
    $("#customer_last_name").removeAttr("lay-verify");
    $("#english_last_name").removeAttr("lay-verify");
    $("#english_first_name").removeAttr("lay-verify");
    $("#card_type").removeAttr("lay-verify");
    $("#gender").removeAttr("lay-verify");
    $("#card_number").removeAttr("lay-verify");
    $("#term_of_validity").removeAttr("lay-verify");
    $("#country_id").removeAttr("lay-verify");
    $("#phone").removeAttr("lay-verify");
    $("#email").removeAttr("lay-verify");
    $("#customer_type").removeAttr("lay-verify");
    $("#language_id").removeAttr("lay-verify");
    $("#room_code").removeAttr("lay-verify");
    $("#room_type").removeAttr("lay-verify");
    $("#check_in").removeAttr("lay-verify");
    $("#check_on").removeAttr("lay-verify");
    //航班信息
    $("input[name='messageFlight']").removeAttr("lay-verify");*/
}

//去除游客的非必填字段
function removeClass(){
    /*$("#company_order_number_hidden").removeAttr("lay-verify");
    $("#customer_first_name").removeAttr("lay-verify");
    $("#customer_last_name").removeAttr("lay-verify");
    $("#english_last_name").removeAttr("lay-verify");
    $("#english_first_name").removeAttr("lay-verify");
    $("#card_type").removeAttr("lay-verify");
    $("#gender").removeAttr("lay-verify");
    $("#card_number").removeAttr("lay-verify");
    $("#term_of_validity").removeAttr("lay-verify");
    $("#country_id").removeAttr("lay-verify");
    $("#phone").removeAttr("lay-verify");
    $("#email").removeAttr("lay-verify");
    $("#customer_type").removeAttr("lay-verify");
    $("#language_id").removeAttr("lay-verify");
    $("#room_code").removeAttr("lay-verify");
    $("#room_type").removeAttr("lay-verify");
    $("#check_in").removeAttr("lay-verify");
    $("#check_on").removeAttr("lay-verify");
    //航班信息
    $("input[name='messageFlight']").removeAttr("lay-verify");*/
}

//去除游客的非必填字段
function removeClass_edit(){
    $("#company_order_number_hidden").removeAttr("lay-verify");
    $("#customer_first_name_edit").removeAttr("lay-verify");
    $("#customer_last_name_edit").removeAttr("lay-verify");
    $("#english_last_name_edit").removeAttr("lay-verify");
    $("#english_first_name_edit").removeAttr("lay-verify");
    $("#card_type_edit").removeAttr("lay-verify");
    $("#gender_edit").removeAttr("lay-verify");
    $("#card_number_edit").removeAttr("lay-verify");
    $("#term_of_validity_edit").removeAttr("lay-verify");
    $("#country_id_edit").removeAttr("lay-verify");
    $("#phone_edit").removeAttr("lay-verify");
    $("#email_edit").removeAttr("lay-verify");
    $("#customer_type_edit").removeAttr("lay-verify");
    $("#language_id_edit").removeAttr("lay-verify");
    $("#room_code_edit").removeAttr("lay-verify");
    $("#room_type_edit").removeAttr("lay-verify");
    $("#check_in_edit").removeAttr("lay-verify");
    $("#check_on_edit").removeAttr("lay-verify");
    //航班信息
    $("input[name='messageFlight_edit']").removeAttr("lay-verify");
}

function getMyDate(str){
    var oDate = new Date(str*1000),
        oYear = oDate.getFullYear(),
        oMonth = oDate.getMonth()+1,
        oDay = oDate.getDate(),
        oHour = oDate.getHours(),
        oMinute = oDate.getMinutes(),
        oSecond = oDate.getSeconds();
        oTime = oYear +'-'+ getzf(oMonth) +'-'+ getzf(oDay) + ' '+getzf(oHour) + ':' + getzf(oMinute) + ':' +getzf(oSecond);//最后拼接时间
    return oTime;
};
//补0操作
function getzf(num){
    if(parseInt(num) < 10){
        num = '0'+num;
    }
    return num;
}

/*游客信息--》table*/
visitorMessBack();
table.on('tool(visitorTable)', function(obj){
    if(obj.event==='lookOne'){
       // console.log("obj")
    }
});

/*游客信息--》添加游客form*/
var num='0';
var gettpl = $('#flightBox').html();
$(".lay-visitor-holderNumber").hide();
form.on('radio(visitorYN)', function(data){
    if(data.value=='是'){
        $("#noPurchased").html("");
        $("#yesPurchased").html($("#yesPurchasedHtml").html());
        /*游客信息--》添加游客form--》航班信息*/
        flight();

        $(".lay-visitor-holderNumber").show();
        $(".visitor-message-other").hide();
        //removeClass();

        $("#visitor-message-other-edit").hide();
    }else{
        $("#yesPurchased").html("");
        $("#noPurchased").html($("#noPurchasedHtml").html());
        /*游客信息--》添加游客form--》航班信息*/
        flight();

        $(".visitor-message-other").show();
        $(".lay-visitor-holderNumber").hide();
        removeClass_zw();

        $("#visitor-message-other-edit").show();
    }
});
function flight() {
    laytpl(gettpl).render(num, function(html){
        $('#flightList').html(html);
    });
    $(".layui-input-date").each(function(){
        laydate.render({
            elem: this,
            type: 'datetime'
        });
    });
    /*label加星号*/
    $(".input-required i").remove();
    $(".input-required").prepend("<i>*</i>");
    form.render();
}
form.on('submit(visitorMessAdd)', function(data){
    var order_hold = data.field.order_hold;
    var company_order_number = $("#company_order_number_hidden").val();
    var occupy_count = $("#occupy_count").val();

    if(order_hold=="是"){
        //站位
        $.ajax({
            type: "POST",
            url: '/product/addCompanyOrderCustomerAjax',
            data: {
                company_order_number:company_order_number,
                occupy_count:occupy_count
            },
            success: function(data){
               
                if(data.code!=200){
                    layer.msg(data.msg);
                    return false;
                }else if(data.code==200) {
                    layer.msg('操作成功',{time:1,end : function(layero, index){
                            location.href='/product/showCompanyOrderCustomerEdit?company_order_number='+company_order_number;
                            // addClass();
                        }
                    });
                }
            }
        });
    }else{
        //游客信息
        var company_order_number = $("#company_order_number_hidden").val();
        var customer_first_name = $("#customer_first_name").val();
        var customer_last_name = $("#customer_last_name").val();
        var english_last_name = $("#english_last_name").val();
        var english_first_name = $("#english_first_name").val();
        var card_type = $("#card_type").val();
        var gender = $("#gender").val();
        var card_number = $("#card_number").val();
        var term_of_validity = $("#term_of_validity").val();
        var country_id = $("#country_id").val();
        var phone = $("#phone").val();
        var email = $("#email").val();
        var customer_type = $("#customer_type").val();
        var language_id = $("#language_id").val();

        //航班信息
        var flight_length = $("input[name='messageFlight']");
        var treeCol=new Array();

        for(var i=0;i<flight_length.length;i++){
            treeCol[i]=new Array();
            var k = i.toString();

            treeCol[i].push($("input[name='messageFlight']:eq("+i+")").val());
            treeCol[i].push($("input[name='orderFlightDate']:eq("+i+")").val());
            treeCol[i].push($("input[name='orderFlightDateE']:eq("+i+")").val());
            treeCol[i].push($("input[name='messageAirport1"+k+"']:checked").val());
            treeCol[i].push($("input[name='orderStartPlace']:eq("+i+")").val());
            treeCol[i].push($("input[name='orderEndPlace']:eq("+i+")").val());
            treeCol[i].push($("input[name='orderRemark']:eq("+i+")").val());
        }

        var customer_flight = treeCol;
        var room_code = $("#room_code").val();
        var room_type = $("#room_type").val();
        var check_in = $("#check_in").val();
        var check_on = $("#check_on").val();

        var check_in_str='';
        for(var ii=0;ii<(-(check_in));ii++){
            check_in_str += $("input[name='check_in_add']:eq("+ii+")").val()+",";
        }

        check_in_str = check_in_str.substring(0, check_in_str.lastIndexOf(','));

        var check_on_str='';
        for(var jj=0;jj<check_on;jj++){
            check_on_str += $("input[name='check_on_add']:eq("+jj+")").val()+",";
        }

        check_on_str = check_on_str.substring(0, check_on_str.lastIndexOf(','));

        // console.log(typeof treeCol);
        // console.log(treeCol);

        //提交游客信息大数组
        $.ajax({
            type: "POST",
            url: '/product/addCompanyOrderCustomerAjax',
            data: {
                "company_order_number":company_order_number,
                "customer_first_name":customer_first_name,
                "customer_last_name":customer_last_name,
                "english_last_name":english_last_name,
                "english_first_name":english_first_name,
                "card_type":card_type,
                "gender":gender,
                "card_number":card_number,
                "term_of_validity":term_of_validity,
                "country_id":country_id,
                "phone":phone,
                "email":email,
                "customer_type":customer_type,
                "language_id":language_id,
                "room_code":room_code,
                "room_type":room_type,
                "check_in":check_in,
                "check_on":check_on,
                "check_in_hotel":check_in_str,
                "check_on_hotel":check_on_str,
                "customer_flight":JSON.stringify(customer_flight)
            },
            success: function(data){
                // console.log(data);
                if(data.code!=200){
                    layer.msg(data.msg);
                    return false;
                }else if(data.code==200) {
                    layer.msg('操作成功',{time:1,end : function(layero, index){
                            location.href='/product/showCompanyOrderCustomerEdit?company_order_number='+company_order_number;

                        }
                    });
                }
            }
        });

    }
    // visitorMessBack()
    // layer.msg("添加！")
    return false;
});

/*游客信息--》添加游客form*/
function visitor() {
    layer.close(layer.index);
    $("#noPurchased").html($("#noPurchasedHtml").html());
    flight()
    $(".lay-visitor-message").hide();
    $(".lay-visitor-add").show();

    removeClass();
}
function visitorMessBack() {
    $(".lay-visitor-message").show();
    $(".lay-visitor-add").hide();

    $("#lay-visitor-edit").hide();

    removeClass_zw();
}

/*住宿信息查看*/
function hotelLook(obj) {
    var gettpl = $('#hotelLook').html();
    var customer_id = $(obj).parent().parent().find("th").eq(0).text();

    $.ajax({
        type: "POST",
        url: '/product/getCustomerInfoAjax',
        data: {
            cc:"hotel",
            customer_id:customer_id,
            company_order_number:$("#company_order_number_hidden").val()
        },
        success: function(data){
            // console.log(data);

            var message = eval('('+data+')');

            laytpl(gettpl).render(message, function(html){
                layer.tips(html, obj, {
                    tips: [4, '#ccc'],
                    padding:'0',
                    tipsMore: false,
                    area: ['450px', 'auto'],
                    closeBtn :1,
                    time:0
                });
            })

        }
    });
}
/*航班信息查看*/
function flightLook(obj) {
    var gettpl = $('#flightLook').html();
    var company_order_number = $("#company_order_number_hidden").val();
    var customer_id = $(obj).parent().parent().find("th").eq(0).text();
    $.ajax({
        type: "POST",
        url: '/product/getCustomerInfoAjax',
        data: {
            cc:"flight",
            customer_id:customer_id,
            company_order_number:company_order_number
        },
        success: function(data){

            var flightList = eval('('+data+')');

            laytpl(gettpl).render(flightList, function(html){
                layer.tips(html, obj, {
                    tips: [4, '#ccc'],
                    padding:'0',
                    tipsMore: false,
                    area: ['500px', 'auto'],
                    closeBtn :1,
                    time:0
                });
            });

        }
    });
}

// laydate.render({
//     elem: '#FlightDate0'
// });

// laydate.render({
//     elem: '#FlightDate0'
// });
// form.render();

/*修改游客信息--》添加游客form--》航班信息*/
/*var gettpl_edit = $('#flightBoxEdit').html();
var num='0';
laytpl(gettpl_edit).render(num, function(html){
    $('#flightList_edit').html(html);
});
laydate.render({
    elem: '#FlightDateEdit0'
});
form.render();*/

function flightAdd() {//点击添加航班
    num=parseInt(num)+1;
    var newNum=num.toString();
    laytpl(gettpl).render(newNum, function(html){
        $('#flightList').append(html);
    });
    $(".layui-input-date").each(function(){
        laydate.render({
            elem: this
            ,type: 'datetime'
        });
    });
    form.render();
}


function flightEdit() {//点击添加航班
    num=parseInt(num)+1;
    var newNum=num.toString();
    laytpl(gettpl).render(newNum, function(html){
        $('#flightList_edit').append(html);
    });
    $(".layui-input-date").each(function(){
        laydate.render({
            elem: this
            ,type: 'datetime'
        });
    });
    $(".layui-flight-edit").css("bottom","15px");
    form.render();
}

function flightListClose(obj) {
    $(obj).parent(".customer-flight-list").slideUp(200).remove();
    if($("#flightList_edit .customer-flight-list").length==0){
        $(".layui-flight-edit").css("bottom","0px")
    }
}
function flightListCloseEdit(obj) {
    $(obj).parent(".customer-flight-list").slideUp(200).remove();
    if($("#flightList_edit .customer-flight-list").length==0){
        $(".layui-flight-edit").css("bottom","0px")
    }
}

//编辑游客信息
function order_customer_edit(obj){

    $(".lay-visitor-message").hide();
    $(".lay-visitor-add").hide();
    $(".visitor-message-other").hide();
    $(".lay-visitor-holderNumber").hide();

    $("#lay-visitor-edit").show();
    $("#visitor-message-other").show();

    var company_order_customer_id = $(obj).attr("company_order_customer");
	$('#company_order_customer_id_hidden').val(company_order_customer_id)
    var company_order_number = $("#company_order_number_hidden").val();

    $.ajax({
        type: "POST",
        url: '/product/getCustomerOnlyAjax',
        data: {
            company_order_number:company_order_number,
            company_order_customer_id:company_order_customer_id
        },
        success: function(data){
			if(data.customer_id==0){
				return false;
			}

			var term_of_validity="";
            var html='';
          
            $("#customer_id_hidden").val(data.customer_id);
            $("#customer_last_name_edit").val(data.customer_last_name);
            $("#customer_first_name_edit").val(data.customer_first_name);
            $("#card_type_edit").val(data.card_type);
            $("#english_last_name_edit").val(data.english_last_name);
            $("#english_first_name_edit").val(data.english_first_name);
            $("#gender_edit").val(data.gender);
            $("#card_number_edit").val(data.card_number);
            if(data.term_of_validity=="1970-01-01"){
                term_of_validity="";
            }else{
                term_of_validity=data.term_of_validity;
            }
            $("#term_of_validity_edit").val(term_of_validity);
            $("#country_id_edit").val(data.country_id);
            $("#phone_edit").val(data.phone);
            $("#email_edit").val(data.email);
            $("#customer_type_edit").val(data.customer_type);
            $("#language_id_edit").val(data.language_id);
           
            for(var i=0;i<data.flight_info.length;i++){
            	
                var kk = i
                kk = kk.toString();
                $("#flightList_edit .customer-flight-list").remove();
                // $("input[name='messageFlight"+i+"']").val(data.flight_info[i].flight_code);
                var flight_code = data.flight_info[i].flight_code;

                if(getMyDate(data.flight_info[i].flight_begin_time)=="1970-01-01 08:00:00"){
                    flight_begin_time="";
                }else{
                    flight_begin_time=getMyDate(data.flight_info[i].flight_begin_time)
                }
                var begin_time = flight_begin_time;
                if(getMyDate(data.flight_info[i].flight_begin_time)=="1970-01-01 08:00:00"){
                    flight_end_time="";
                }else{
                    flight_end_time=getMyDate(data.flight_info[i].flight_end_time)
                }
                var end_time = flight_end_time;
                var flight_type = data.flight_info[i].flight_type

                if(flight_code==null){
                    flight_code = '';
                }else{
                    flight_code = flight_code;
                }

                if(flight_type==1){
                	var type1='checked';
                	var type2='';
                	var type3='';
                }else if(flight_type==2){
                	var type1='';
                	var type2='checked';
                	var type3='';
                }else if(flight_type==3){
                	var type1='';
                	var type2='';
                	var type3='checked';
                }else if(flight_type==null){
                    var type1='';
                    var type2='';
                    var type3='';
                }

                var start_place = data.flight_info[i].start_place;
                if(start_place==null){
                    start_place='';
                }else{
                    start_place=start_place;
                }

                var end_place = data.flight_info[i].end_place;
                if(end_place==null){
                    end_place='';
                }else{
                    end_place=end_place;
                }

                html+='<div class="customer-flight-list"><hr>'+
                    
                    '<div class="layui-row layui-form">'+
                    '<div class="layui-col-md4">'+
                    '<div class="layui-form-item">'+
                    '<label class="layui-form-label">航班:</label>'+
                    '<div class="layui-input-block">'+
                    '<input type="text" name="messageFlight" placeholder="请输入" autocomplete="off" class="layui-input input-flight-node" value="'+flight_code+'" lay-verify="required">'+
                    '</div>'+
                    '</div>'+
                    '</div>'+
                    '<div class="layui-col-md4">'+
                    '<div class="layui-form-item">'+
                    '<label class="layui-form-label">航班时间:</label>'+
                    '<div class="layui-input-block">'+
                    '<input type="text" name="orderFlightDate" placeholder="请输入" autocomplete="off" class="layui-input layui-input-date input-flight-time s" value="'+begin_time+'" style="display:inline;width:48%" lay-verify="required"> / '+
                    '<input type="text" name="orderFlightDateE" placeholder="请输入" autocomplete="off" class="layui-input layui-input-date input-flight-time e" value="'+end_time+'" style="display:inline;width:48%" lay-verify="required">'+
                    '</div>'+
                    '</div>'+
                    '</div>'+
                    '<div class="layui-col-md4">'+
                    '<div class="layui-form-item">'+
                    '<label class="layui-form-label"></label>'+
                    '<div class="layui-input-block">'+
                    '<input type="radio" '+type1+' name="messageAirport1'+kk+'" value="1" title="接机" class="input-flight-type">'+
                    '<input type="radio" '+type2+' name="messageAirport1'+kk+'" value="2" title="送机" class="input-flight-type">'+
                    '<input type="radio" '+type3+' name="messageAirport1'+kk+'" value="3" title="中转" class="input-flight-type">'+
                    '</div>'+
                    '</div>'+
                    '</div>'+
                    '</div>'+
                    '<div class="layui-row">'+
                    '<div class="layui-col-md4">'+
                    '<div class="layui-form-item">'+
                    '<label class="layui-form-label">出发地:</label>'+
                    '<div class="layui-input-block">'+
                    '<input type="text" name="orderStartPlace" placeholder="请输入" autocomplete="off" class="layui-input input-flight-startplace" value="'+start_place+'" lay-verify="required">'+
                    '</div>'+
                    '</div>'+
                    '</div>'+
                    '<div class="layui-col-md4">'+
                    '<div class="layui-form-item">'+
                    '<label class="layui-form-label">目的地:</label>'+
                    '<div class="layui-input-block">'+
                    '<input type="text" name="orderEndPlace" placeholder="请输入" autocomplete="off" class="layui-input input-flight-endplace" value="'+end_place+'" lay-verify="required">'+
                    '</div>'+
                    '</div>'+
                    '</div>'+
                    '</div>'+
                    '<div class="layui-row">'+
                    '<div class="layui-col-md4">'+
                    '<div class="layui-form-item">'+
                    '<label class="layui-form-label">备注:</label>'+
                    '<div class="layui-input-block">'+
                    '<input type="text" name="orderRemark" placeholder="请输入" autocomplete="off" class="layui-input input-flight-endplace" value="" lay-verify="required">'+
                    '</div>'+
                    '</div>'+
                    '</div>'+
                    '</div>'+
                    '<i class="layui-icon layui-icon-close flight-list-close" onclick="flightListCloseEdit(this)"></i>'+
                    '</div>';

                $("#flightList_edit").append(html);

                $(".layui-input-date").each(function(){
                    laydate.render({
                        elem: this
                        ,type: 'datetime'
                    });
                });
                $(".input-required i").remove();
                $(".input-required").prepend("<i>*</i>");
                form.render();

                $("#company_order_customer_id_hidden").val(company_order_customer_id);
                if(i!=0){
                	num++;
                }
            }

            for(var i=0;i<data.flight_info.length;i++){
                $("input:radio[name='messageAirport1"+i+"'][value='"+data.flight_info[i].flight_type+"']").attr("checked",'checked');
            }

            $("#room_code_edit").val(data.accommodation_info[0].room_code);
            $("#room_type_edit").val(data.accommodation_info[0].room_type);
            $("#check_in_edit").val(data.accommodation_info[0].check_in);
            $("#check_on_edit").val(data.accommodation_info[0].check_on);

            if(data.accommodation_info[0].check_in==-1){
                //提前1天
                $("#edit_hn11").show();
                $("#edit_hn12").hide();
                $("#edit_hn13").hide();
                $("#edit_hn14").hide();
                $("#edit_hn15").hide();
            }else if(data.accommodation_info[0].check_in==-2){
                //提前2天
                $("#edit_hn11").show();
                $("#edit_hn12").show();
                $("#edit_hn13").hide();
                $("#edit_hn14").hide();
                $("#edit_hn15").hide();
            }else if(data.accommodation_info[0].check_in==-3){
                //提前3天
                $("#edit_hn11").show();
                $("#edit_hn12").show();
                $("#edit_hn13").show();
                $("#edit_hn14").hide();
                $("#edit_hn15").hide();
            }else if(data.accommodation_info[0].check_in==-4){
                //提前4天
                $("#edit_hn11").show();
                $("#edit_hn12").show();
                $("#edit_hn13").show();
                $("#edit_hn14").show();
                $("#edit_hn15").hide();
            }else if(data.accommodation_info[0].check_in==-5){
                //提前5天
                $("#edit_hn11").show();
                $("#edit_hn12").show();
                $("#edit_hn13").show();
                $("#edit_hn14").show();
                $("#edit_hn15").show();
            }else if(data.accommodation_info[0].check_in==0){
                //没特殊要求
                $("#edit_hn11").hide();
                $("#edit_hn12").hide();
                $("#edit_hn13").hide();
                $("#edit_hn14").hide();
                $("#edit_hn15").hide();
            }

            var check_in_hotel_array = [];
            check_in_hotel_array = (data.accommodation_info[0].check_in_hotel).split(",");

            $("input[name='check_in_edit']").each(function(index,data){
                $(this).val(check_in_hotel_array[index]);
            });

            //--------------------------------------------------------------------------------------------------

            if(data.accommodation_info[0].check_on==1){
                //延后1天
                $("#tt1").show();
                $("#edit_hn21").show();
                $("#edit_hn22").hide();
                $("#edit_hn23").hide();
                $("#edit_hn24").hide();
                $("#edit_hn25").hide();
            }else if(data.accommodation_info[0].check_on==2){
                //延后2天
                $("#tt1").show();
                $("#tt2").show();
                $("#edit_hn21").show();
                $("#edit_hn22").show();
                $("#edit_hn23").hide();
                $("#edit_hn24").hide();
                $("#edit_hn25").hide();
            }else if(data.accommodation_info[0].check_on==3){
                //延后3天
                $("#tt1").show();
                $("#tt2").show();
                $("#tt3").show();
                $("#edit_hn21").show();
                $("#edit_hn22").show();
                $("#edit_hn23").show();
                $("#edit_hn24").hide();
                $("#edit_hn25").hide();
            }else if(data.accommodation_info[0].check_on==4){
                //延后4天
                $("#tt1").show();
                $("#tt2").show();
                $("#tt3").show();
                $("#tt4").show();
                $("#edit_hn21").show();
                $("#edit_hn22").show();
                $("#edit_hn23").show();
                $("#edit_hn24").show();
                $("#edit_hn25").hide();
            }else if(data.accommodation_info[0].check_on==5){
                //延后5天
                $("#tt1").show();
                $("#tt2").show();
                $("#tt3").show();
                $("#tt4").show();
                $("#tt5").show();
                $("#edit_hn21").show();
                $("#edit_hn22").show();
                $("#edit_hn23").show();
                $("#edit_hn24").show();
                $("#edit_hn25").show();
            }else if(data.accommodation_info[0].check_on==0){
                //没特殊要求
                $("#edit_hn21").hide();
                $("#edit_hn22").hide();
                $("#edit_hn23").hide();
                $("#edit_hn24").hide();
                $("#edit_hn25").hide();
            }

            var check_on_hotel_array = [];
            check_on_hotel_array = (data.accommodation_info[0].check_on_hotel).split(",");

            $("input[name='check_on_edit']").each(function(index,data){
                $(this).val(check_on_hotel_array[index]);
            });

            form.render('select');
            form.render('radio');
        }
    });
    if($("#flightList_edit .customer-flight-list").length==0){
        $(".layui-flight-edit").css("bottom","0px")
    }
}

//编辑游客-基础信息
function order_customer_edit_ajax(){
    //去除表单验证过滤
   /* removeClass_zw();
    removeClass();
    removeClass_edit_zw();
    removeClass_edit();*/

    // var treeCol=new Array();
    //
    // for(var i=1;i<($(".input-flight-node").length);i++){
    //     treeCol[i]=new Array();
    //
    //     treeCol[i].push($(".input-flight-node:eq("+i+")").val());
    //     treeCol[i].push($(".s:eq("+i+")").val());
    //     treeCol[i].push($(".e:eq("+i+")").val());
    //     treeCol[i].push($(".input-flight-type:eq("+(i-1)+")").val());
    //     treeCol[i].push($(".input-flight-startplace:eq("+i+")").val());
    //     treeCol[i].push($(".input-flight-endplace:eq("+i+")").val());
    //
    // }

    //航班信息
    var flight_length = $("input[name='messageFlight']");
    var treeCol=new Array();

    for(var i=0;i<flight_length.length;i++){
        treeCol[i]=new Array();
        var k = i;
        treeCol[i].push($("input[name='messageFlight']:eq("+i+")").val());
        treeCol[i].push($("input[name='orderFlightDate']:eq("+i+")").val());
        treeCol[i].push($("input[name='orderFlightDateE']:eq("+i+")").val());
        treeCol[i].push($("input[name='messageAirport1"+k+"']:checked").val());
        treeCol[i].push($("input[name='orderStartPlace']:eq("+i+")").val());
        treeCol[i].push($("input[name='orderEndPlace']:eq("+i+")").val());
  
    }

    //航班数组
    var customer_flight = treeCol;
    

    var company_order_customer_id = parseInt($("#company_order_customer_id_hidden").val());
	
    var customer_id = parseInt($("#customer_id_hidden").val());
    var company_order_number = $("#company_order_number_hidden").val();
    var customer_first_name = $("#customer_first_name_edit").val();
    var customer_last_name = $("#customer_last_name_edit").val();
    var english_last_name = $("#english_last_name_edit").val();
    var english_first_name = $("#english_first_name_edit").val();
    var card_type = $("#card_type_edit").val();
    var gender = $("#gender_edit").val();
    var card_number = $("#card_number_edit").val();
    var term_of_validity = $("#term_of_validity_edit").val();
    var country_id = $("#country_id_edit").val();
    var phone = $("#phone_edit").val();
    var email = $("#email_edit").val();
    var customer_type = $("#customer_type_edit").val();
    var language_id = $("#language_id_edit").val();
    var room_code = $("#room_code_edit").val();
    var room_type = $("#room_type_edit").val();
    var check_in = $("#check_in_edit").val();
    var check_on = $("#check_on_edit").val();

    var check_in_hotel = '';
    for(var iii=0;iii<-(check_in);iii++){
        check_in_hotel+=($("input[name='check_in_edit']:eq("+iii+")").val())+",";
    }
    check_in_hotel = check_in_hotel.substring(0, check_in_hotel.lastIndexOf(','));

    var check_on_hotel = '';
    for(var jjj=0;jjj<check_on;jjj++){
        check_on_hotel+=($("input[name='check_on_edit']:eq("+jjj+")").val())+",";
    }
    check_on_hotel = check_on_hotel.substring(0, check_on_hotel.lastIndexOf(','));
    

    $.ajax({
        type: "POST",
        url: '/product/editCompanyOrderCustomerBaseAjax',
        data: {
            company_order_customer_id:company_order_customer_id,
            customer_id:customer_id,
            company_order_number:company_order_number,
            customer_first_name:customer_first_name,
            customer_last_name:customer_last_name,
            english_last_name:english_last_name,
            english_first_name:english_first_name,
            card_type:card_type,
            gender:gender,
            card_number:card_number,
            term_of_validity:term_of_validity,
            country_id:country_id,
            phone:phone,
            email:email,
            customer_type:customer_type,
            language_id:language_id,
            room_code:room_code,
            room_type:room_type,
            check_in:check_in,
            check_on:check_on,
            check_in_hotel:check_in_hotel,
            check_on_hotel:check_on_hotel,
            customer_flight:JSON.stringify(customer_flight)
        },
        success: function(data){
			
            if(data.code!=200){
                //layer.msg(data.msg);
                return false;
            }else if(data.code==200) {
                layer.msg('操作成功',{time:1,end : function(layero, index){
                        location.href='/product/showCompanyOrderCustomerEdit?company_order_number='+company_order_number;

                    }
                });
            }
        }
    });

    return false;
}

//删除游客和站位信息
function delete_customer(obj){

    var company_order_customer_id = $(obj).parent().parent().find("th").eq(15).html();
    var company_order_number = (window.location.search).split("=")[1];

    $.ajax({
        type: "POST",
        url: '/product/deleteCompanyOrderCustomerAjax',
        data: {
            company_order_customer_id:company_order_customer_id,
            company_order_number:company_order_number
        },
        success: function(data){
            // console.log(data);
            if(data.code!=200){
                layer.msg(data.msg);
                return false;
            }else if(data.code==200) {
                layer.msg('操作成功',{time:1,end : function(layero, index){
                        location.reload();
                    }
                });
            }
        }
    });
}

$(".layui-table").each(function (index,item) {
    if($(item).find("tbody tr").length===0){
        var width=$(item).parent(".table-company").width()-2;
        $(item).find("tfoot").hide();
        $(item).parents(".table-company").css("padding-bottom","50px").append("<div class='table-none' style='width: "+width+"px'>暂无数据</div>");
    }
})

$("input[type='radio']").each(function(){
    var xuanzhong = $(this).attr('data-check');
    if(xuanzhong == "false"){
        $('.t-body input').each(function (i, input) {
            $(input).attr('data-check', "false");
        })
        $(this).attr('data-check', "true");
        $(this).prop('checked', true);
        layui.form.render();
    } else{
        $('.t-body input').each(function (i,input) {
            $(input).attr('data-check', "false");
        })
        $(this).prop('checked', false);
        layui.form.render();
    }
});

//添加入住关联
form.on('select(check_in)', function(data){
    //提前入住
    if(data.value==-1){
        $("#hn11").show();
        $("#hn12").hide();
        $("#hn13").hide();
        $("#hn14").hide();
        $("#hn15").hide();
    }else if(data.value==-2){
        $("#hn11").show();
        $("#hn12").show();
        $("#hn13").hide();
        $("#hn14").hide();
        $("#hn15").hide();
    }else if(data.value==-3){
        $("#hn11").show();
        $("#hn12").show();
        $("#hn13").show();
        $("#hn14").hide();
        $("#hn15").hide();
    }else if(data.value==-4){
        $("#hn11").show();
        $("#hn12").show();
        $("#hn13").show();
        $("#hn14").show();
        $("#hn15").hide();
    }else if(data.value==-5){
        $("#hn11").show();
        $("#hn12").show();
        $("#hn13").show();
        $("#hn14").show();
        $("#hn15").show();
    }else if(data.value==0){
        $("#hn11").hide();
        $("#hn12").hide();
        $("#hn13").hide();
        $("#hn14").hide();
        $("#hn15").hide();
    }else if(data.value==1){
        $("#hn11").hide();
        $("#hn12").hide();
        $("#hn13").hide();
        $("#hn14").hide();
        $("#hn15").hide();
    }else if(data.value==2){
        $("#hn11").hide();
        $("#hn12").hide();
        $("#hn13").hide();
        $("#hn14").hide();
        $("#hn15").hide();
    }else if(data.value==3){
        $("#hn11").hide();
        $("#hn12").hide();
        $("#hn13").hide();
        $("#hn14").hide();
        $("#hn15").hide();
    }else if(data.value==4){
        $("#hn11").hide();
        $("#hn12").hide();
        $("#hn13").hide();
        $("#hn14").hide();
        $("#hn15").hide();
    }else if(data.value==5){
        $("#hn11").hide();
        $("#hn12").hide();
        $("#hn13").hide();
        $("#hn14").hide();
        $("#hn15").hide();
    }
});

//添加退房关联
form.on('select(check_on)', function(data){
    //延后退房
    if(data.value==1){
        $("#dd1").show();
        $("#hn21").show();
        $("#hn22").hide();
        $("#hn23").hide();
        $("#hn24").hide();
        $("#hn25").hide();
    }else if(data.value==2){
        $("#dd1").show();
        $("#dd2").show();
        $("#hn21").show();
        $("#hn22").show();
        $("#hn23").hide();
        $("#hn24").hide();
        $("#hn25").hide();
    }else if(data.value==3){
        $("#dd1").show();
        $("#dd2").show();
        $("#dd3").show();
        $("#hn21").show();
        $("#hn22").show();
        $("#hn23").show();
        $("#hn24").hide();
        $("#hn25").hide();
    }else if(data.value==4){
        $("#dd1").show();
        $("#dd2").show();
        $("#dd3").show();
        $("#dd4").show();
        $("#hn21").show();
        $("#hn22").show();
        $("#hn23").show();
        $("#hn24").show();
        $("#hn25").hide();
    }else if(data.value==5){
        $("#dd1").show();
        $("#dd2").show();
        $("#dd3").show();
        $("#dd4").show();
        $("#dd5").show();
        $("#hn21").show();
        $("#hn22").show();
        $("#hn23").show();
        $("#hn24").show();
        $("#hn25").show();
    }else if(data.value==0){
        $("#hn21").hide();
        $("#hn22").hide();
        $("#hn23").hide();
        $("#hn24").hide();
        $("#hn25").hide();
    }else if(data.value==-1){
        $("#hn21").hide();
        $("#hn22").hide();
        $("#hn23").hide();
        $("#hn24").hide();
        $("#hn25").hide();
    }else if(data.value==-2){
        $("#hn21").hide();
        $("#hn22").hide();
        $("#hn23").hide();
        $("#hn24").hide();
        $("#hn25").hide();
    }else if(data.value==-3){
        $("#hn21").hide();
        $("#hn22").hide();
        $("#hn23").hide();
        $("#hn24").hide();
        $("#hn25").hide();
    }else if(data.value==-4){
        $("#hn21").hide();
        $("#hn22").hide();
        $("#hn23").hide();
        $("#hn24").hide();
        $("#hn25").hide();
    }else if(data.value==-5){
        $("#hn21").hide();
        $("#hn22").hide();
        $("#hn23").hide();
        $("#hn24").hide();
        $("#hn25").hide();
    }
});

//修改入住关联
form.on('select(check_in_edit)', function(data){
    //提前入住
    if(data.value==-1){
        $("#edit_hn11").show();
        $("#edit_hn12").hide();
        $("#edit_hn13").hide();
        $("#edit_hn14").hide();
        $("#edit_hn15").hide();
    }else if(data.value==-2){
        $("#edit_hn11").show();
        $("#edit_hn12").show();
        $("#edit_hn13").hide();
        $("#edit_hn14").hide();
        $("#edit_hn15").hide();
    }else if(data.value==-3){
        $("#edit_hn11").show();
        $("#edit_hn12").show();
        $("#edit_hn13").show();
        $("#edit_hn14").hide();
        $("#edit_hn15").hide();
    }else if(data.value==-4){
        $("#edit_hn11").show();
        $("#edit_hn12").show();
        $("#edit_hn13").show();
        $("#edit_hn14").show();
        $("#edit_hn15").hide();
    }else if(data.value==-5){
        $("#edit_hn11").show();
        $("#edit_hn12").show();
        $("#edit_hn13").show();
        $("#edit_hn14").show();
        $("#edit_hn15").show();
    }else if(data.value==0){
        $("#edit_hn11").hide();
        $("#edit_hn12").hide();
        $("#edit_hn13").hide();
        $("#edit_hn14").hide();
        $("#edit_hn15").hide();
    }else if(data.value==1){
        $("#edit_hn11").hide();
        $("#edit_hn12").hide();
        $("#edit_hn13").hide();
        $("#edit_hn14").hide();
        $("#edit_hn15").hide();
    }else if(data.value==2){
        $("#edit_hn11").hide();
        $("#edit_hn12").hide();
        $("#edit_hn13").hide();
        $("#edit_hn14").hide();
        $("#edit_hn15").hide();
    }else if(data.value==3){
        $("#edit_hn11").hide();
        $("#edit_hn12").hide();
        $("#edit_hn13").hide();
        $("#edit_hn14").hide();
        $("#edit_hn15").hide();
    }else if(data.value==4){
        $("#edit_hn11").hide();
        $("#edit_hn12").hide();
        $("#edit_hn13").hide();
        $("#edit_hn14").hide();
        $("#edit_hn15").hide();
    }else if(data.value==5){
        $("#edit_hn11").hide();
        $("#edit_hn12").hide();
        $("#edit_hn13").hide();
        $("#edit_hn14").hide();
        $("#edit_hn15").hide();
    }
});

//修改退房关联
form.on('select(check_on_edit)', function(data){
    //延后退房
    if(data.value==1){
        $("#tt1").show();
        $("#edit_hn21").show();
        $("#edit_hn22").hide();
        $("#edit_hn23").hide();
        $("#edit_hn24").hide();
        $("#edit_hn25").hide();
    }else if(data.value==2){
        $("#tt1").show();
        $("#tt2").show();
        $("#edit_hn21").show();
        $("#edit_hn22").show();
        $("#edit_hn23").hide();
        $("#edit_hn24").hide();
        $("#edit_hn25").hide();
    }else if(data.value==3){
        $("#tt1").show();
        $("#tt2").show();
        $("#tt3").show();
        $("#edit_hn21").show();
        $("#edit_hn22").show();
        $("#edit_hn23").show();
        $("#edit_hn24").hide();
        $("#edit_hn25").hide();
    }else if(data.value==4){
        $("#tt1").show();
        $("#tt2").show();
        $("#tt3").show();
        $("#tt4").show();
        $("#edit_hn21").show();
        $("#edit_hn22").show();
        $("#edit_hn23").show();
        $("#edit_hn24").show();
        $("#edit_hn25").hide();
    }else if(data.value==5){
        $("#tt1").show();
        $("#tt2").show();
        $("#tt3").show();
        $("#tt4").show();
        $("#tt5").show();
        $("#edit_hn21").show();
        $("#edit_hn22").show();
        $("#edit_hn23").show();
        $("#edit_hn24").show();
        $("#edit_hn25").show();
    }else if(data.value==0){
        $("#edit_hn21").hide();
        $("#edit_hn22").hide();
        $("#edit_hn23").hide();
        $("#edit_hn24").hide();
        $("#edit_hn25").hide();
    }else if(data.value==-1){
        $("#edit_hn21").hide();
        $("#edit_hn22").hide();
        $("#edit_hn23").hide();
        $("#edit_hn24").hide();
        $("#edit_hn25").hide();
    }else if(data.value==-2){
        $("#edit_hn21").hide();
        $("#edit_hn22").hide();
        $("#edit_hn23").hide();
        $("#edit_hn24").hide();
        $("#edit_hn25").hide();
    }else if(data.value==-3){
        $("#edit_hn21").hide();
        $("#edit_hn22").hide();
        $("#edit_hn23").hide();
        $("#edit_hn24").hide();
        $("#edit_hn25").hide();
    }else if(data.value==-4){
        $("#edit_hn21").hide();
        $("#edit_hn22").hide();
        $("#edit_hn23").hide();
        $("#edit_hn24").hide();
        $("#edit_hn25").hide();
    }else if(data.value==-5){
        $("#edit_hn21").hide();
        $("#edit_hn22").hide();
        $("#edit_hn23").hide();
        $("#edit_hn24").hide();
        $("#edit_hn25").hide();
    }
});